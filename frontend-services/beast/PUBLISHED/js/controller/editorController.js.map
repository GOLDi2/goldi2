{"version":3,"file":"editorController.js","sourceRoot":"","sources":["editorController.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Created by maximilian on 30.05.17.\n */\ndeclare var ExpressionExtractor: any;\n\ninterface EditorWorkspaceControllerInterface {\n    closeEditor(editor: EditorController);\n\n    selectEditor(editor: EditorController);\n\n    openComponent(component: GlobalComponentTypeID);\n\n    resolveComponentType(id: GlobalComponentTypeID): Component\n\n    componentModified(component: CompoundComponent, id: GlobalComponentTypeID)\n\n    createComponent(component: CompoundComponent | string): GlobalComponentTypeID;\n\n    createAndOpenComponent(component: CompoundComponent | string);\n}\n\n\nclass EditorController {\n    protected readonly SHORTCUTS = {\n        delete: () => this.workspace.removeSelection()\n    };\n    protected readonly CTRL_SHORTCUTS = {\n        arrowleft: () => this.workspace.rotateSelection(-90),\n        arrowright: () => this.workspace.rotateSelection(90),\n        a: () => this.workspace.selectAll(),\n    };\n    protected readonly SHIFT_CTRL_SHORTCUTS = {\n        e: () => this.extractComponent()\n    };\n\n    protected workspace: Workspace.Workspace;\n    protected toolbar: JQuery;\n    protected tabPane: JQuery;\n    protected tab: JQuery;\n\n    protected componentName: string;\n\n    constructor(protected controller: EditorWorkspaceControllerInterface, component: CompoundComponent, public originalComponentID: GlobalComponentTypeID, protected componentID: GlobalComponentTypeID, contentContainer: JQuery, tabContainer: JQuery, closeable: boolean) {\n        this.tabPane = $('.tab-pane.template')\n            .clone()\n            .removeClass('template');\n        contentContainer.append(this.tabPane);\n\n        const $ws = this.tabPane.find('.workspace');\n\n        this.workspace = new Workspace.Workspace($ws.parent(), this, component);\n        $ws.remove();\n        const workspace = this.tabPane.find('svg');\n        workspace.addClass('workspace flex-grow-equal');\n\n        //Bind Toolbar events\n        this.tabPane.find('.btn-delete')\n            .click(() => this.workspace.removeSelection());\n        this.tabPane.find('.btn-parameter')\n            .click(() => this.workspace.editSelectionParameters());\n        this.tabPane.find('.cb-connsim')\n            .change(() => this.workspace.setShowConnectorState((<HTMLInputElement>this.tabPane.find('.cb-connsim')[0]).checked));\n        this.tabPane.find('.cb-pan')\n            .change(() => this.workspace.setDragMode((<HTMLInputElement>this.tabPane.find('.cb-pan')[0]).checked ? 'pan' : 'select'));\n        this.tabPane.find('.cb-tooltip')\n            .change(() => this.workspace.setShowParameterTooltips((<HTMLInputElement>this.tabPane.find('.cb-tooltip')[0]).checked));\n        this.tabPane.find('.btn-zoomin')\n            .click(() => this.workspace.setRelativeZoom(1.5));\n        this.tabPane.find('.btn-zoomout')\n            .click(() => this.workspace.setRelativeZoom(1 / 1.5));\n        this.tabPane.find('.zoom-group > input')\n            .on({\n                dblclick: () => {\n                    console.info(\"Zommreset\");\n                    this.workspace.resetZoom()\n                }\n            }, \"input\");\n        this.tabPane.find('.btn-rotateleft')\n            .click(() => this.workspace.rotateSelection(-90));\n        this.tabPane.find('.btn-rotateright')\n            .click(() => this.workspace.rotateSelection(90));\n        this.tabPane.find('.btn-extract')\n            .click(() => this.extractComponent());\n        this.tabPane.find('input:checkbox')\n            .bootstrapToggle();\n\n        this.tabPane.find('#grabEquations')\n            .click(() => this.grabEquations(this.workspace));\n        // .click(this.grabEquations);\n\n        if (!(jQuery.contains(document.documentElement, workspace[0]))) {\n            console.error(\"Not visible!\")\n        }\n\n        this.tabPane.attr('tabindex', '0');\n        this.tabPane.keyup(this.keyUpHandler);\n        $('body')\n            .bind('paste cut copy', this.clipboardAction);\n\n        this.tab = $('.tabbarelement.template')\n            .clone()\n            .removeClass('template');\n        tabContainer.append(this.tab);\n        this.tab.find('.tabtitle')\n            .text(component.name);\n        this.componentName = component.name;\n        const closeLink = this.tab.find('.closetab');\n        if (closeable) {\n            closeLink.click((e) => {\n                e.preventDefault();\n                e.stopPropagation();\n                this.controller.closeEditor(this);\n            });\n        } else {\n            closeLink.remove();\n        }\n        this.tab.click(() => this.controller.selectEditor(this));\n        this.workspace.setShowConnectorState(true);\n    }\n\n    clipboardAction = (event: JQueryEventObject) => {\n        /*TODO: Find better solution to only act when the workspace is selected\n         * This cannot be done by binding the event to the tabContainer only,\n         * because then the event does not fire in Chrome! */\n        if (!this.tabPane.is(':focus')) {\n            return;\n        }\n\n        const e = <ClipboardEvent>event.originalEvent;\n        if (e.type === 'paste') {\n            console.log(JSON.parse(e.clipboardData.getData('text/json')));\n\n            this.workspace.pasteSubcircuit(JSON.parse(e.clipboardData.getData('text/json')));\n        }\n        if (e.type === 'cut' || e.type === 'copy') {\n            e.clipboardData.setData('text/json', JSON.stringify(this.workspace.getSelectedSubcircuit()));\n        }\n        if (e.type === 'cut') {\n            this.workspace.removeSelection();\n        }\n        e.preventDefault();\n        e.stopPropagation();\n    };\n\n    keyUpHandler = (event) => {\n        const key = event.key.toLowerCase();\n        let handler = this.SHORTCUTS[key];\n        if (event.ctrlKey) {\n            handler = this.CTRL_SHORTCUTS[key] || handler;\n        }\n        if (event.ctrlKey && event.shiftKey) {\n            handler = this.SHIFT_CTRL_SHORTCUTS[key] || handler;\n        }\n        if (handler !== undefined) {\n            event.preventDefault();\n            event.stopPropagation();\n            handler();\n        }\n    };\n\n    getLibraryComponent(identifier: GlobalComponentTypeID): Workspace.Circuit {\n        return this.controller.resolveComponentType(identifier);\n    };\n\n    circuitModified(stateOnly: boolean) {\n        if (this.componentID == null) {\n            if (!stateOnly) {\n                new ComponentCreationDialog((name) => {\n                    const component = <CompoundComponent>this.workspace.getCircuit();\n                    this.componentID = this.controller.createComponent(new CompoundComponent(null, name, component.devices, component.connectors));\n                    this.originalComponentID = this.componentID;\n                    this.tab.find('.tabtitle')\n                        .text(name);\n                }, false).show();\n            }\n\n        } else {\n            const circuit = this.workspace.getCircuit();\n            this.controller.componentModified(new CompoundComponent(this.componentID.componentID, this.componentName, circuit.devices, circuit.connectors), this.componentID);\n        }\n    };\n\n    openCompoundComponent(component: GlobalComponentTypeID, workspace: Workspace.Workspace) {\n        this.controller.openComponent(component);\n    };\n\n    updateAbilities(abilities: Workspace.Abilities) {\n        this.tabPane.find('.btn-delete')\n            .prop('disabled', !abilities.removeSelected);\n        this.tabPane.find('.btn-rotateleft')\n            .prop('disabled', !abilities.rotateSelection);\n        this.tabPane.find('.btn-rotateright')\n            .prop('disabled', !abilities.rotateSelection);\n        this.tabPane.find('.btn-parameter')\n            .prop('disabled', !abilities.editSelectionParameters);\n    }\n\n    getSimulationInterface(): SimulationInterface {\n        return this.workspace.getSimulationInterface();\n    }\n\n    activateTab() {\n        this.tabPane.attr('style', '');\n        this.tabPane.addClass('active');\n        this.tab.addClass('active');\n    }\n\n    deactivateTab() {\n        this.tabPane.attr('style', 'display: none !important');\n        this.tabPane.removeClass('active');\n        this.tab.removeClass('active');\n    }\n\n    remove() {\n        this.tab.remove();\n        this.tabPane.remove();\n    }\n\n    extractComponent() {\n        new ComponentCreationDialog((name) => {\n            const component = <CompoundComponent>this.workspace.getCircuit();\n            this.controller.createAndOpenComponent(new CompoundComponent(null, name, component.devices, component.connectors));\n        }, true).show();\n    }\n\n    grabEquations(workspace) {\n        let expressions: any = [];\n        try {\n            let circuit = this.workspace.getCircuit();\n            // @ts-ignore\n            expressions = new ExpressionExtractor().extractExpressions(circuit, this.getComponentWrapper.bind(this));\n        } catch (e) {\n\n        }\n        if (expressions.length > 0) {\n            new GrabExpressionsDialog(expressions).show();\n        } else {\n            InfoDialog.showDialog('No expressions were found');\n\n        }\n    }\n\n    getComponentWrapper(libraryId, componentId) {\n        return this.getLibraryComponent(new GlobalComponentTypeID(libraryId, componentId));\n    }\n\n    zoomChanged(zoomfactor: number) {\n        this.tabPane.find(\".zoom-group > input\").val(parseFloat((zoomfactor * 100).toPrecision(2)) + \" %\");\n    }\n\n    public reinitUI() {\n        this.tabPane.find('input:checkbox')\n            .bootstrapToggle(\"destroy\").bootstrapToggle();\n        this.workspace.updatePositions();\n    }\n}\n\nclass ComponentCreationDialog extends Dialog {\n    protected input: JQuery;\n\n    constructor(protected callbackFunction: (name: string) => void, protected extracting: boolean) {\n        super();\n    }\n\n    protected getTitle(): string {\n        return this.extracting ? 'Extract Component' : 'Save as new Component?';\n    }\n\n    protected getContent(): JQuery {\n        const text = this.extracting ? '<p><b>Please choose a name for the extracted component:</b></p>' :\n            '<p>To save your modifications to this circuit,<br>it has to be saved as a new' +\n            ' component!</p>' +\n            '<p><b>Please choose a name:</b></p>';\n\n        const content: JQuery = $('<div></div>')\n            .append(text);\n        this.input = $('<input type=\"text\"/>');\n        this.input.val('New Component');\n        this.input.addClass('beast-horizontal-fill');\n        content.append(this.input);\n\n        this.input.on('input', () => {\n            this.setButtonDisabled(this.extracting ? 'Extract' : 'Save', this.input.val().length == 0);\n        });\n\n        this.addButton(this.extracting ? 'Extract' : 'Save', this.extracting ? 'glyphicon glyphicon-share' : 'glyphicon ' +\n            'glyphicon-floppy-disk', this.confimedEvent);\n        this.addButton('Cancel', 'glyphicon glyphicon-remove', () => this.close());\n\n        this.registerKeyListener((key: number) => {\n            //enter\n            if (key == 13) {\n                this.confimedEvent();\n            }\n        });\n\n        return content;\n    }\n\n    confimedEvent = () => {\n        const val: string = this.input.val();\n        if (val.length != 0) {\n            this.callbackFunction(this.input.val());\n            this.close();\n        }\n    };\n}\n\nclass GrabExpressionsDialog extends Dialog {\n\n    constructor(private expressions) {\n        super();\n    }\n\n    protected getTitle(): string {\n        return 'Grab equation';\n    }\n\n    protected getContent(): JQuery {\n        let text = '<p><b>Expressions that were found:</b></p>';\n        this.expressions.forEach((expression, i) => {\n            text += '<span class=\"grabbed-expression\">' + expression.output + ' = ' + expression.expression + '</span><br/>'\n        });\n\n        const content: JQuery = $('<div></div>')\n            .append(text);\n        const self = this;\n        content.find('.grabbed-expression')\n            .on('click', function () {\n                self.selectText($(this));\n            });\n\n        this.addButton('Ok', 'glyphicon glyphicon-remove', () => this.close());\n\n        this.registerKeyListener((key: number) => {\n            //enter\n            if (key == 13) {\n                this.close();\n            }\n        });\n\n        return content;\n    }\n\n    selectText(element) {\n        element.select();\n        const selection = window.getSelection();\n        const range = document.createRange();\n        range.selectNodeContents(element[0]);\n        selection.removeAllRanges();\n        selection.addRange(range);\n    }\n}"]}