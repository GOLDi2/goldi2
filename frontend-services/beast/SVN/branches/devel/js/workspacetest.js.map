{"version":3,"file":"workspacetest.js","sourceRoot":"","sources":["workspacetest.ts"],"names":[],"mappings":"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","sourcesContent":["import SimulationInterface = Workspace.SimulationInterface;\n/**\n * Created by maximilian on 18.05.17.\n */\n\nvar tester: WorkspaceTester;\n\nvar dirtyCounter: number = 0;\n\nfunction setDirty(dirty: boolean) {\n    let marker = $(\"#dirtymarker\");\n    if (dirty){\n        dirtyCounter = dirtyCounter+1;\n        marker.text(\"dirty (\"+ dirtyCounter +\")\").css({\"backgroundColor\": \"red\"});\n    }\n    else {\n        dirtyCounter = 0;\n        marker.text(\"clean\").css({\"backgroundColor\": \"green\"});\n    }\n}\n\nclass WorkspaceTester{\n    public workspace: Workspace.Workspace;\n    public simInterface: SimulationInterface;\n    \n    protected indicators: {[name:string]: JQuery} = {};\n    \n    constructor () {\n        this.workspace = new Workspace.Workspace($(\"#workspacecontainer\"),this, {height: 700, width: 700,\n            \"devices\": [\n                {\"type\": \"In\", \"label\": \"A\", \"id\": \"dev0\", \"x\": 72, \"y\": 56},\n                {\"type\": \"In\", \"label\": \"B\", \"id\": \"dev1\", \"x\": 56, \"y\": 240},\n                {\"type\": \"Out\", \"label\": \"Y\", \"id\": \"dev2\", \"x\": 400, \"y\": 232},\n                {\"type\": \"Out\", \"label\": \"X\", \"id\": \"dev3\", \"x\": 368, \"y\": 48},\n                {\"type\": \"AND\", \"id\": \"dev4\", \"x\": 232, \"y\": 48},\n                {\"type\": \"Toggle\", \"id\": \"dev5\", \"x\": -8, \"y\": 240, \"state\": {\"on\": false}},\n                {\"type\": \"DC\", \"id\": \"dev6\", \"x\": -128, \"y\": 152},\n                {\"type\": \"Toggle\", \"id\": \"dev7\", \"x\": -8, \"y\": 56, \"state\": {\"on\": false}},\n                {\"type\": \"LED\", \"label\": \"LED\", \"color\": \"#0000ff\", \"bgColor\": \"#000000\", \"id\": \"dev8\", \"x\": 464, \"y\": 40},\n                {\"type\": \"LED\", \"id\": \"dev9\", \"x\": 480, \"y\": 232},\n                {\"type\": \"OR\", \"id\": \"dev10\", \"x\": 288, \"y\": 232},\n                {\"type\": \"OSC\", \"id\": \"dev11\", \"x\": 184, \"y\": 192}\n            ],\n            \"connectors\": [\n                {\"from\": \"dev0.in0\", \"to\": \"dev7.out0\"},\n                {\"from\": \"dev1.in0\", \"to\": \"dev5.out0\"},\n                {\"from\": \"dev2.in0\", \"to\": \"dev10.out0\"},\n                {\"from\": \"dev3.in0\", \"to\": \"dev4.out0\"},\n                {\"from\": \"dev4.in0\", \"to\": \"dev0.out0\"},\n                {\"from\": \"dev4.in1\", \"to\": \"dev1.out0\"},\n                {\"from\": \"dev5.in0\", \"to\": \"dev6.out0\"},\n                {\"from\": \"dev7.in0\", \"to\": \"dev6.out0\"},\n                {\"from\": \"dev8.in0\", \"to\": \"dev3.out0\"},\n                {\"from\": \"dev9.in0\", \"to\": \"dev2.out0\"},\n                {\"from\": \"dev10.in0\", \"to\": \"dev11.out0\"},\n                {\"from\": \"dev10.in1\", \"to\": \"dev1.out0\"}\n            ]\n        });\n        this.simInterface = this.workspace.getSimulationInterface();\n    }\n    \n    getLibraryComponent(identifier: GlobalComponentTypeID): Workspace.Circuit {\n        throw new Error('not implemented');\n    };\n    circuitModified() {\n        setDirty(true);\n    };\n    openCompoundComponent(identifier: GlobalComponentTypeID, workspace: Workspace.Workspace) {\n        alert(\"Open \" + identifier + \" in new Tab!\");\n    };\n    \n    listPorts() {\n        let inlist = $(\"#inlist\");\n        inlist.empty();\n        for (let inname of this.simInterface.getInputNames()) {\n            let setterCB = $('<input type=\"checkbox\" class=\"settercb\">');\n            setterCB.change((event) => {\n                const value = (<HTMLInputElement>setterCB[0]).checked;\n                this.simInterface.setInput(inname, value);\n            });\n            inlist.append($(\"<li></li>\").text(inname).append(setterCB));\n        }\n    \n        let outlist = $(\"#outlist\");\n        outlist.empty();\n        this.indicators = {};\n        for (let outname of this.simInterface.getOutputNames()) {\n            let indicator = $('<div class=\"portindicator\"></div>');\n            this.indicators[outname] = indicator;\n            outlist.append($(\"<li></li>\").text(outname).append(indicator));\n        }\n    }\n    \n    changeHandler = (name: string, value: boolean) => {\n        this.indicators[name].toggleClass(\"portindicator-hot\", value);\n        this.indicators[name].toggleClass(\"portindicator-cold\", !value);\n    }\n    \n    setAutoUpdate(value:boolean) {\n        if (value) {\n            this.simInterface.onOutputChange(this.changeHandler);\n        }\n        else {\n            this.simInterface.offOutputChange(this.changeHandler);\n        }\n    }\n    \n    setAll() {\n        $(\".settercb\").trigger(\"change\");\n    }\n    \n    readValues() {\n        let values = this.simInterface.getOutputs();\n        for (let outname in this.indicators) {\n            this.indicators[outname].toggleClass(\"portindicator-hot\", values[outname]);\n            this.indicators[outname].toggleClass(\"portindicator-cold\", !values[outname]);\n        }\n    }\n}\n\nfunction init() {\n    tester = new WorkspaceTester();\n    $(\"#removeSelection\").click(() => tester.workspace.removeSelection());\n    $(\"#parameterDialog\").click(() => tester.workspace.editSelectionParameters());\n    $(\"#exportButton\").click(() => $(\"#outdata\").val(JSON.stringify(tester.workspace.getCircuit(), null, 2)));\n    $(\"#exportSubcircuit\").click(() => $(\"#outdata\").val(JSON.stringify(tester.workspace.getSelectedSubcircuit(), null, 2)));\n    $(\"#pasteSubcircuit\").click(() => tester.workspace.pasteSubcircuit(JSON.parse($(\"#outdata\").val())));\n    $(\"#dirtymarker\").click(() => setDirty(false));\n    $(\"#setshowTooltip\").change(() => tester.workspace.setShowParameterTooltips((<HTMLInputElement>$(\"#setshowTooltip\")[0]).checked));\n    $(\"#setPan\").change(() => tester.workspace.setDragMode((<HTMLInputElement>$(\"#setPan\")[0]).checked ? \"pan\": \"select\"));\n    $(\"#setDisplayState\").change(() => tester.workspace.setShowConnectorState((<HTMLInputElement>$(\"#setDisplayState\")[0]).checked));\n    \n    \n    \n    $(\"#rotateLeft\").click(() => tester.workspace.rotateSelection(-90));\n    $(\"#rotateRight\").click(() => tester.workspace.rotateSelection(90));\n    \n    $(\"#listPorts\").click(() => tester.listPorts());\n    $(\"#activate\").click(() => {tester.simInterface.activate(); tester.setAll()});\n    $(\"#deactivate\").click(() => tester.simInterface.deactivate());\n    $(\"#readvalues\").click(() => tester.readValues());\n    $(\"#autoupdate\").change(() => tester.setAutoUpdate((<HTMLInputElement>$(\"#autoupdate\")[0]).checked));\n    \n    \n    setDirty(false);\n}\n\n$(document).ready(init);"]}